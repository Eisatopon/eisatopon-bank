#!/usr/bin/env python3
"""
Add 4 images to math_competitions_2018_2019_latex.json
Run this script in the same directory as your JSON file

Usage:
    python3 add_images_to_2018_2019.py
"""

import json
import sys
import os

def main():
    input_file = 'math_competitions_2018_2019_latex.json'
    output_file = 'math_competitions_2018_2019_latex_WITH_IMAGES.json'
    
    # Check if input file exists
    if not os.path.exists(input_file):
        print(f"âŒ Error: {input_file} not found!")
        print(f"   Make sure this script is in the same directory as your JSON file")
        sys.exit(1)
    
    print("=" * 70)
    print("Adding 4 images to 2018-2019 JSON")
    print("=" * 70)
    print()
    
    # Read the JSON file
    print(f"ğŸ“– Reading {input_file}...")
    with open(input_file, 'r', encoding='utf-8') as f:
        content = f.read()
    
    print(f"   File size: {len(content):,} bytes")
    print()
    
    # Apply 4 modifications
    modifications_made = 0
    
    # 1. Î˜Î±Î»Î®Ï‚ Î’' Î“Ï…Î¼Î½Î±ÏƒÎ¯Î¿Ï… Problem 2
    print("1ï¸âƒ£  Adding image to Î˜Î±Î»Î®Ï‚ Î’' Î“Ï…Î¼Î½Î±ÏƒÎ¯Î¿Ï… Î ÏÏŒÎ²Î»Î·Î¼Î± 2...")
    old1 = 'ÎºÎ±Î¹ $AB = AH$. ÎÎ± Î±Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ ÏŒÏ„Î¹:'
    new1 = "ÎºÎ±Î¹ $AB = AH$.<div style='text-align: center; margin: 10px 0;'><img src='https://raw.githubusercontent.com/eisatopon/eisatopon-bank/main/images/thalis_2018_B_gymnasiou_2.png' alt='Î£Ï‡Î®Î¼Î±' style='max-width: 100%; height: auto;'/></div> ÎÎ± Î±Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ ÏŒÏ„Î¹:"
    
    if old1 in content:
        content = content.replace(old1, new1, 1)
        modifications_made += 1
        print("   âœ… Image added!")
    else:
        print("   âš ï¸  Pattern not found - skipping")
    
    # 2. Î˜Î±Î»Î®Ï‚ Î“' Î“Ï…Î¼Î½Î±ÏƒÎ¯Î¿Ï… Problem 4
    print("2ï¸âƒ£  Adding image to Î˜Î±Î»Î®Ï‚ Î“' Î“Ï…Î¼Î½Î±ÏƒÎ¯Î¿Ï… Î ÏÏŒÎ²Î»Î·Î¼Î± 4...")
    old2 = '($AB = AE$), Î½Î± Î±Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ ÏŒÏ„Î¹:'
    new2 = "($AB = AE$),<div style='text-align: center; margin: 10px 0;'><img src='https://raw.githubusercontent.com/eisatopon/eisatopon-bank/main/images/thalis_2018_G_gymnasiou_4.png' alt='Î£Ï‡Î®Î¼Î±' style='max-width: 100%; height: auto;'/></div> Î½Î± Î±Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ ÏŒÏ„Î¹:"
    
    if old2 in content:
        content = content.replace(old2, new2, 1)
        modifications_made += 1
        print("   âœ… Image added!")
    else:
        print("   âš ï¸  Pattern not found - skipping")
    
    # 3. Î•Ï…ÎºÎ»ÎµÎ¯Î´Î·Ï‚ Î’' Î“Ï…Î¼Î½Î±ÏƒÎ¯Î¿Ï… Problem 2
    print("3ï¸âƒ£  Adding image to Î•Ï…ÎºÎ»ÎµÎ¯Î´Î·Ï‚ Î’' Î“Ï…Î¼Î½Î±ÏƒÎ¯Î¿Ï… Î ÏÏŒÎ²Î»Î·Î¼Î± 2...")
    old3 = 'ÎµÎ¯Î½Î±Î¹ Ï„ÎµÏ„ÏÎ¬Î³Ï‰Î½Î¿.\\n\\n(Î±) ÎÎ± Î²ÏÎµÎ¯Ï„Îµ'
    new3 = "ÎµÎ¯Î½Î±Î¹ Ï„ÎµÏ„ÏÎ¬Î³Ï‰Î½Î¿.<div style='text-align: center; margin: 10px 0;'><img src='https://raw.githubusercontent.com/eisatopon/eisatopon-bank/main/images/euklidis_2019_B_gymnasiou_2.png' alt='Î£Ï‡Î®Î¼Î±' style='max-width: 100%; height: auto;'/></div>\\n\\n(Î±) ÎÎ± Î²ÏÎµÎ¯Ï„Îµ"
    
    if old3 in content:
        content = content.replace(old3, new3, 1)
        modifications_made += 1
        print("   âœ… Image added!")
    else:
        print("   âš ï¸  Pattern not found - skipping")
    
    # 4. Î•Ï…ÎºÎ»ÎµÎ¯Î´Î·Ï‚ Î“' Î“Ï…Î¼Î½Î±ÏƒÎ¯Î¿Ï… Problem 3
    print("4ï¸âƒ£  Adding image to Î•Ï…ÎºÎ»ÎµÎ¯Î´Î·Ï‚ Î“' Î“Ï…Î¼Î½Î±ÏƒÎ¯Î¿Ï… Î ÏÏŒÎ²Î»Î·Î¼Î± 3...")
    old4 = '$\\\\angle \\\\Gamma O\\\\Delta = 90^\\\\circ$. ÎŸÎ¹ ÎµÏ…Î¸ÎµÎ¯ÎµÏ‚'
    new4 = "$\\\\angle \\\\Gamma O\\\\Delta = 90^\\\\circ$.<div style='text-align: center; margin: 10px 0;'><img src='https://raw.githubusercontent.com/eisatopon/eisatopon-bank/main/images/euklidis_2019_G_gymnasiou_3.png' alt='Î£Ï‡Î®Î¼Î±' style='max-width: 100%; height: auto;'/></div> ÎŸÎ¹ ÎµÏ…Î¸ÎµÎ¯ÎµÏ‚"
    
    if old4 in content:
        content = content.replace(old4, new4, 1)
        modifications_made += 1
        print("   âœ… Image added!")
    else:
        print("   âš ï¸  Pattern not found - skipping")
    
    print()
    print(f"ğŸ“Š Summary: {modifications_made}/4 images added")
    print()
    
    # Verify it's still valid JSON
    print("ğŸ” Verifying JSON validity...")
    try:
        json.loads(content)
        print("   âœ… JSON is valid!")
    except json.JSONDecodeError as e:
        print(f"   âŒ JSON is invalid: {e}")
        sys.exit(1)
    
    # Write output file
    print(f"ğŸ’¾ Writing {output_file}...")
    with open(output_file, 'w', encoding='utf-8') as f:
        f.write(content)
    
    print(f"   File size: {len(content):,} bytes")
    print()
    print("=" * 70)
    print("âœ… SUCCESS!")
    print("=" * 70)
    print()
    print(f"Output file: {output_file}")
    print()
    print("Next steps:")
    print(f"1. Rename {output_file}")
    print(f"   to math_competitions_2018_2019_latex.json")
    print("2. Upload to GitHub along with the 4 image files:")
    print("   - thalis_2018_B_gymnasiou_2.png")
    print("   - thalis_2018_G_gymnasiou_4.png")
    print("   - euklidis_2019_B_gymnasiou_2.png")
    print("   - euklidis_2019_G_gymnasiou_3.png")
    print()

if __name__ == '__main__':
    main()
